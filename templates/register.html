{% load static %}
<!DOCTYPE html>
<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Bootstrap Login Form Template</title>

        <!-- CSS -->
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500">
        <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
        <link rel="stylesheet" href="{% static 'font-awesome/css/font-awesome.min.css' %}">
		<link rel="stylesheet" href="{% static 'css/form-elements.css' %}">
        <link rel="stylesheet" href="{% static 'css/style.css' %}">

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Favicon and touch icons -->
        <link rel="shortcut icon" href="{% static 'ico/favicon.png' %}">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{% static 'ico/apple-touch-icon-144-precomposed.png' %}">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="{% static 'ico/apple-touch-icon-114-precomposed.png' %}">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{% static 'ico/apple-touch-icon-72-precomposed.png' %}">
        <link rel="apple-touch-icon-precomposed" href="{% static 'ico/apple-touch-icon-57-precomposed.png' %}">

    </head>

    <body background="{% static 'image/2.jpg' %}">

        <!-- Top content -->
        <div class="top-content">

            <div class="inner-bg">
                <div class="container">
                    <div class="row">
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-sm-offset-3 form-box">
                        	<div class="form-top">
                        		<div class="form-top-left">
                        			<h3>注册</h3>      <a href="{% url 'login' %}">登录</a>
                                    <br>
                                    填写信息进行注册
                                    <div style="color: brown">{{ error }}</div>

                        		</div>
                        		<div class="form-top-right">
                        			<i class="fa fa-lock"></i>
                        		</div>
                            </div>
                            <div class="form-bottom">
			                    <form role="form" action="" method="post" class="login-form">
			                    	<div class="form-group">
			                    		<label class="sr-only" for="username">账号</label>
			                        	<input type="text" name="username" placeholder="Username..." class="username form-control" id="username">
                                        <span></span>
			                        </div>
                                    <div class="form-group">
			                        	<label class="sr-only" for="password">密码</label>
			                        	<input type="password" name="password" placeholder="Password..." class="form-password form-control" id="password">
			                        </div>
                                    <div class="form-group">
			                    		<label class="sr-only" for="phone">电话</label>
			                        	<input type="text" name="phone" placeholder="phone" class="form-username form-control" id="phone">
			                        </div>
                                    <div class="form-group">
			                    		<label class="sr-only" for="email">邮箱</label>
			                        	<input type="text" name="email" placeholder="email" class="email form-control" id="email">
			                        </div>
                                    <div class="form-group">
			                    		<label class="sr-only" for="age">年龄</label>
			                        	<input type="text" name="age" placeholder="age" class="form-username form-control" id="age">
			                        </div>
                                    <div class="form-group">
			                    		<label class="sr-only" for="sex">性别</label>
			                        	<input type="text" name="sex" placeholder="sex" class="form-username form-control" id="sex">
			                        </div>
                                    <div class="form-group">
			                    		<label class="sr-only" for="adress">地址</label>
			                        	<input type="text" name="adress" placeholder="adress" class="form-username form-control" id="adress">
			                        </div>
                                    <div class="form-group">
			                    		<label class="sr-only" for="education">学历</label>
			                        	<input type="text" name="education" placeholder="education" class="form-username form-control" id="education">
			                        </div>


			                        <button type="submit" class="btn">注册</button>
			                    </form>
		                    </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>



        <!-- Javascript -->
        <script src="{% static 'js/jquery-1.11.1.min.js' %}"></script>
        <script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
        <script src="{% static 'js/jquery.backstretch.min.js' %}"></script>
        <script src="{% static 'js/scripts.js' %}"></script>

        <!--[if lt IE 10]>
            <script src="assets/js/placeholder.js"></script>
        <![endif]-->

    </body>
<script src="{% static 'js/jquery-1.11.1.min.js' %}"></script>
<script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/jquery.backstretch.min.js' %}"></script>
<script src="{% static 'js/scripts.js' %}"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#username").blur(
        function () {
            username=$("#username").val();//获取用户的值
            url = "{% url 'registers' %}";
            console.log(username);
            $.ajax(
                {
                    url:url,
                    type:'get',
                    data:'code='+username,
                    success:function (data) {
                     if (data.content== 'false' ){
                            $('#username').next().html('*账号已存在');
                        }else{
                            $('#username').next().html('可以注册该账号');
                        }if (data.content== '' ){
                            $('#username').next().html('账号不能为空');
                        }
                        console.log(data);
                    $('#span').html(data.content);
                    console.log(data.content);
                    console.log(data.code)
                    },
                    error:function (error) {
                        console.log(error);
                    }
                }
            );
        }
    )
    })

</script>
<script>
$(function(){
        //1，打开页面时验证必填项
        $('form input.required').each(function(){
            //console.log($(this).val());
            var txt = $(this).val();
            if(txt=="" || txt.length==0){
                //$(this).after("<span class='msg'>*</span>")
                $(this).siblings('span').first().html('*')
            }
        })

        //2，失去焦点
        $('form :input').blur(function(event){
            //删除*号
            $(this).parent().find('.msg').remove();
            //密码
            console.log('密码:'+$(this).is('#password'));
            if($(this).is('#password')){
                var password = $(this).val();
                var regpwd = /^.*(?=.{6,})(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&*? ]).*$/;
                if(password=='' || password.length==0 || regpwd.test(password)==false){
                    $(this).after("<span class='msg'>密码不合法</span>")
                }else{
                    $(this).after("<span class='msg'>密码正确</span>")
                }
            }

            //学历
            console.log('学历:'+$(this).is('#education'));
            if($(this).is('#education')){
                var education = $(this).val();
                var regeducation = /[\u4E00-\u9FA5]/;
                if(education=='' || education.length==0 || regeducation.test(education)==false){
                    $(this).after("<span class='msg'>学历不合法</span>")
                }else{
                    $(this).after("<span class='msg'>学历正确</span>")
                }
            }
            //性别
            console.log('性别:'+$(this).is('#sex'));
            if($(this).is('#sex')){
                var sex = $(this).val();
                var regeducation = /[\u4E00-\u9FA5]/;
                if(sex=='' || sex.length==0 || regeducation.test(sex)==false){
                    $(this).after("<span class='msg'>输入不合法</span>")
                }else{
                    $(this).after("<span class='msg'>正确</span>")
                }
            }
            //地址
            console.log('地址:'+$(this).is('#adress'));
            if($(this).is('#adress')){
                var adress = $(this).val();
                var regrole =  /^\d+$/;
                if(adress=='' || adress.length==0 || regrole.test(adress)==false || adress.length>1){
                    $(this).after("<span class='msg'>填写地址</span>")
                }else{
                    $(this).after("<span class='msg'>地址正确</span>")
                }
            }
            console.log('年龄:'+$(this).is('#age'));
            if($(this).is('#age')){
                var age = $(this).val();
                var regphone = /[1-9][0-9]?/;
                if(age=='' || age.length==0 || regphone.test(age)==false){
                    $(this).after("<span class='msg'>年龄不合法</span>")
                }else{
                    $(this).after("<span class='msg'>输入正确</span>")
                }
            }


            //电话
            console.log('电话:'+$(this).is('#phone'));
            if($(this).is('#phone')){
                var phone = $(this).val();
                var regphone = /^1[34578]\d{9}$/;
                if(phone=='' || phone.length==0 || regphone.test(phone)==false){
                    $(this).after("<span class='msg'>手机号不合法</span>")
                }else{
                    $(this).after("<span class='msg'>手机号正确</span>")
                }
            }

            //邮箱
            console.log('邮箱:'+$(this).is('#email'));
            if($(this).is('#email')){
                var email = $(this).val();
                var regemail = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
                if(email=='' || email.length==0 || regemail.test(email)==false){
                    $(this).after("<span class='msg'>邮箱不合法</span>")
                }else{
                    $(this).after("<span class='msg'>邮箱正确</span>")
                }
            }

        }).keyup(function(event){
            console.log("抬起直接调用blur......");
            $(this).triggerHandler('blur')
        }).focus(function(event){
            $(this).triggerHandler('blur')
        });

        //3，表单提交时，各种规则验证
        $('form').submit(function(event){
            var isGo = true
            //判断，失败标记值=false
            $("input.required").each(function(){
                zhi = $(this).val().trim();//去空格
                if(zhi=='' || zhi.length==0){
                    isGo = false;
                }
            })
            if(isGo==false){
                $('h1').slideDown(3000)
            }
            return isGo;
        })
    })
</script>
</html>
